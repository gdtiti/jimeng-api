# 即梦API环境变量配置示例
# 复制此文件为 .env 并根据需要修改配置

# ===========================================
# 基础服务配置
# ===========================================

# 服务端口
PORT=5566

# 服务绑定地址
HOST=0.0.0.0

# Node.js 环境
NODE_ENV=production

# 日志级别 (debug, info, warn, error)
LOG_LEVEL=info

# 是否启用详细日志
VERBOSE_LOGGING=false

# ===========================================
# URL配置 - 支持多个地址用分号分隔
# ===========================================

# 即梦中国服务URL
JIMENG_CN_URLS=https://jimeng.jianying.com

# 即梦国际服务URL - 支持多个镜像地址
JIMENG_US_URLS=https://api-proxy-1.deno.dev/dreamina/us;https://dreamina-api.us.capcut.com

# ImageX中国服务URL
IMAGEX_CN_URLS=https://imagex.bytedanceapi.com

# ImageX国际服务URL
IMAGEX_US_URLS=https://imagex16-normal-us-ttp.capcutapi.us
# 商业服务URL（积分相关）
COMMERCE_US_URLS=https://commerce.us.capcut.com

# ===========================================
# 认证配置
# ===========================================

# 认证缓存时间（毫秒）
AUTH_CACHE_TTL=300000

# Cookie缓存时间（毫秒）
COOKIE_CACHE_TTL=300000

# 用户信息缓存时间（毫秒）
USER_INFO_CACHE_TTL=600000

# 积分信息缓存时间（毫秒）
CREDIT_INFO_CACHE_TTL=30000

# ===========================================
# 请求配置
# ===========================================

# 默认请求超时时间（毫秒）
REQUEST_TIMEOUT=45000

# 最大重试次数
MAX_RETRY_COUNT=3

# 重试延迟时间（毫秒）
RETRY_DELAY=5000

# 重试退避倍数
RETRY_BACKOFF_MULTIPLIER=2

# ===========================================
# URL管理配置
# ===========================================

# URL健康检查间隔（毫秒）
URL_HEALTH_CHECK_INTERVAL=300000

# URL健康检查超时（毫秒）
URL_HEALTH_CHECK_TIMEOUT=5000

# 默认URL负载均衡策略
# random: 随机选择
# round-robin: 轮询选择
# failover: 故障转移（使用第一个可用的）
DEFAULT_URL_STRATEGY=random

# ===========================================
# 性能监控配置
# ===========================================

# 是否启用性能监控
ENABLE_PERFORMANCE_MONITORING=true

# 指标收集间隔（毫秒）
METRICS_COLLECTION_INTERVAL=60000

# 是否启用健康检查
ENABLE_HEALTH_CHECK=true

# 健康检查间隔（毫秒）
HEALTH_CHECK_INTERVAL=300000

# ===========================================
# 安全配置
# ===========================================

# 最大文件大小（字节）
MAX_FILE_SIZE=104857600

# 支持的文件类型（用逗号分隔）
ALLOWED_FILE_TYPES=jpg,jpeg,png,webp,gif,bmp,tiff,heic,avif

# 是否启用请求验证
ENABLE_REQUEST_VALIDATION=true

# 是否启用速率限制
ENABLE_RATE_LIMITING=true

# 速率限制窗口（毫秒）
RATE_LIMIT_WINDOW=60000

# 速率限制最大请求数
RATE_LIMIT_MAX_REQUESTS=100

# ===========================================
# 缓存配置
# ===========================================

# 生成结果缓存配置
RESULT_CACHE_SUCCESS_TTL=3600000    # 成功结果缓存1小时
RESULT_CACHE_FAILURE_TTL=300000     # 失败结果缓存5分钟

# 用户权限缓存时间（毫秒）
USER_PERMISSION_CACHE_TTL=600000    # 10分钟

# 模型配置缓存时间（毫秒）
MODEL_CONFIG_CACHE_TTL=1800000      # 30分钟

# ===========================================
# 功能开关
# ===========================================

# 是否启用故障转移
ENABLE_FAILOVER=true

# 是否启用请求缓存
ENABLE_REQUEST_CACHE=true

# 是否启用智能重试
ENABLE_SMART_RETRY=true

# 是否启用批量操作
ENABLE_BATCH_OPERATIONS=true

# 是否启用性能优化
ENABLE_PERFORMANCE_OPTIMIZATION=true

# ===========================================
# 地区配置
# ===========================================

# 默认地区 (cn, us)
DEFAULT_REGION=cn

# 中国地区默认语言
DEFAULT_LANGUAGE_CN=zh-CN

# 国际地区默认语言
DEFAULT_LANGUAGE_US=en-US

# 中国地区时区
TIMEZONE_CN=Asia/Shanghai

# 国际地区时区
TIMEZONE_US=America/New_York

# ===========================================
# 模型配置
# ===========================================

# 默认图片生成模型
DEFAULT_IMAGE_MODEL=jimeng-4.0

# 默认视频生成模型
DEFAULT_VIDEO_MODEL=jimeng-video-3.0

# 模型配置缓存时间（毫秒）
MODEL_CONFIG_CACHE_TTL=1800000

# ===========================================
# 开发模式配置
# ===========================================

# 是否启用调试模式
DEBUG_MODE=false

# 是否启用模拟模式
MOCK_MODE=false

# 是否启用详细日志
VERBOSE_LOGGING=false

# 是否启用热重载
ENABLE_HOT_RELOAD=false

# ===========================================
# Docker配置
# ===========================================

# Docker容器名称
DOCKER_CONTAINER_NAME=jimeng-api

# Docker镜像标签
DOCKER_IMAGE_TAG=latest

# Docker网络配置
DOCKER_NETWORK=bridge

# ===========================================
# 监控和日志
# ===========================================

# 日志文件路径
LOG_FILE_PATH=./logs/app.log

# 错误日志文件路径
ERROR_LOG_FILE_PATH=./logs/error.log

# 访问日志文件路径
ACCESS_LOG_FILE_PATH=./logs/access.log

# 日志文件最大大小（字节）
LOG_MAX_FILE_SIZE=10485760

# 日志文件保留数量
LOG_MAX_FILES=5

# ===========================================
# 数据库配置（如果使用）
# ===========================================

# 数据库连接URL
DATABASE_URL=

# Redis连接URL
REDIS_URL=

# 缓存前缀
CACHE_PREFIX=jimeng_api:

# ===========================================
# 第三方服务配置
# ===========================================

# Sentry错误追踪DSN
SENTRY_DSN=

# 通知服务Webhook
NOTIFICATION_WEBHOOK_URL=

# 分析服务API密钥
ANALYTICS_API_KEY=

# ===========================================
# 实验性功能
# ===========================================

# 是否启用实验性功能
ENABLE_EXPERIMENTAL_FEATURES=false

# 实验性功能列表（逗号分隔）
EXPERIMENTAL_FEATURES=

# A/B测试配置
AB_TEST_CONFIG=

# ===========================================
# 备份和恢复
# ===========================================

# 备份配置文件路径
BACKUP_CONFIG_PATH=./backups/

# 自动备份间隔（小时）
AUTO_BACKUP_INTERVAL_HOURS=24

# 最大备份数量
MAX_BACKUP_COUNT=7

# ===========================================
# 限制和配额
# ===========================================

# 每用户每日最大请求数
DAILY_REQUEST_LIMIT_PER_USER=1000

# 每IP每分钟最大请求数
MINUTE_REQUEST_LIMIT_PER_IP=60

# 并发连接数限制
MAX_CONCURRENT_CONNECTIONS=100

# 请求体最大大小（字节）
MAX_REQUEST_BODY_SIZE=10485760

# ===========================================
# 自定义配置
# ===========================================

# 自定义API前缀
CUSTOM_API_PREFIX=

# 自定义响应头
CUSTOM_RESPONSE_HEADERS=

# 自定义中间件配置
CUSTOM_MIDDLEWARE_CONFIG=

# ===========================================
# 生产环境优化
# ===========================================

# 是否启用压缩
ENABLE_COMPRESSION=true

# 压缩阈值（字节）
COMPRESSION_THRESHOLD=1024

# 是否启用静态文件缓存
ENABLE_STATIC_CACHE=true

# 静态文件缓存时间（秒）
STATIC_CACHE_TTL=3600

# ===========================================
# 警告和通知
# ===========================================

# 错误通知邮件
ERROR_NOTIFICATION_EMAIL=

# 系统管理员邮件
ADMIN_EMAIL=

# 告警阈值配置
ALERT_THRESHOLDS=

# ===========================================
# 安全增强配置
# ===========================================

# CORS允许的源
CORS_ALLOWED_ORIGINS=*

# CORS允许的方法
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS

# CORS允许的头部
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# 是否启用CSP
ENABLE_CSP=false

# CSP策略内容
CSP_POLICY=

# ===========================================
# 国际化配置
# ===========================================

# 支持的语言列表
SUPPORTED_LANGUAGES=zh-CN,en-US,ja-JP,ko-KR

# 默认语言
DEFAULT_LANGUAGE=zh-CN

# 语言文件路径
LOCALE_PATH=./locales/

# ===========================================
# 调试和开发工具
# ===========================================

# 是否启用API文档
ENABLE_API_DOCS=true

# API文档路径
API_DOCS_PATH=/docs

# 是否启用Swagger UI
ENABLE_SWAGGER_UI=true

# Swagger UI路径
SWAGGER_UI_PATH=/swagger

# ===========================================
# 性能调优
# ===========================================

# 事件循环延迟监控阈值（毫秒）
EVENT_LOOP_DELAY_THRESHOLD=100

# 内存使用率警告阈值（百分比）
MEMORY_USAGE_WARNING_THRESHOLD=80

# CPU使用率警告阈值（百分比）
CPU_USAGE_WARNING_THRESHOLD=80

# 响应时间警告阈值（毫秒）
RESPONSE_TIME_WARNING_THRESHOLD=5000

# ===========================================
# 其他配置
# ===========================================

# 服务版本号
SERVICE_VERSION=1.3.0

# 服务构建时间
BUILD_TIME=

# Git提交哈希
GIT_COMMIT_HASH=

# 部署环境标识
DEPLOYMENT_ENV=production

# 数据中心标识
DATACENTER_ID=default

# 服务器实例ID
SERVER_INSTANCE_ID=

# ===========================================
# 配置说明
# ===========================================

# 1. URL配置说明：
#    - 使用分号(;)分隔多个URL
#    - 系统会根据配置的策略自动选择最优URL
#    - 支持随机、轮询、故障转移三种策略

# 2. 认证配置说明：
#    - 新格式：使用"....."分隔的完整cookie字符串
#    - 旧格式：直接使用refreshToken（向后兼容）
#    - 系统会自动通过capcut_locale字段判断地区

# 3. 缓存配置说明：
#    - 所有时间配置都以毫秒为单位
#    - 可以根据实际使用情况调整缓存时间
#    - 生产环境建议适当增加缓存时间

# 4. 安全配置说明：
#    - 生产环境建议启用所有安全特性
#    - 定期更新密钥和敏感配置
#    - 使用HTTPS协议

# 5. 监控配置说明：
#    - 建议启用所有监控功能
#    - 配置合适的告警阈值
#    - 定期检查日志和监控数据

# 更多配置选项请参考 config-example.yml 文件
# 完整的配置文档请查看 .spec-workflow/接口文档/ 目录